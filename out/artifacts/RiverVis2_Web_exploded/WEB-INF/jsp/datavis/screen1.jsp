<%@ page language="java" import="java.util.*" pageEncoding="utf-8"%>
<%
	String path = request.getContextPath();
	String basePath = request.getScheme() + "://"
			+ request.getServerName() + ":" + request.getServerPort()
			+ path + "/";
%>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<base href="<%=basePath%>">
	
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="refresh" content="10">
    
  <!--   <link rel="stylesheet" href="leaflet.css" /> 
	<script src="leaflet.js"></script>--> 
	
	<link rel="stylesheet" href="<%=path%>/js/leaflet.css" /> 
	<script src="<%=path%>/js/leaflet.js"></script>


	

	<style>#map { width: 600px; height: 525px; }
		.info { padding: 6px 8px; font: 14px/16px Arial, Helvetica, sans-serif; background: white; background: rgba(255,255,255,0.8); box-shadow: 0 0 15px rgba(0,0,0,0.2); border-radius: 5px; } .info h4 { margin: 0 0 5px; color: #777; }
		.legend { text-align: left; line-height: 18px; color: #555; } .legend i { width: 18px; height: 18px; float: left; margin-right: 8px; opacity: 0.7; }
	</style>
	<script language="javascript" src="<%=path%>/js/jquery-1.3.2.min.js"></script>
	

	
</head>

<body>
    <div>
    <div id='map'></div>  <!--为雨量地图准备一个具备大小（宽高）的Dom-->
    <div id="main" style="height:525px;width:625px;border:0px solid #ccc;padding:0px;  position:relative;top:-525px;left:625px"></div>   <!--Step:1 为ECharts准备一个具备大小（宽高）的Dom-->
    </div>
 
    <!--Step:2 引入echarts-all.js-->
   <!-- 此处开始添加相应的地图信息 -->
  <script type="text/JavaScript" src="<%=path%>/js/echarts-all.js"></script>
  <script language="javascript" src="<%=path%>/js/jquery-1.3.2.min.js"></script>
   
  <script type="text/javascript">
  $(top.hangge());//关闭加载状态
  var myChart = echarts.init(document.getElementById('main'));
  //alert(1);
   function rain(a,b,c,d,e,f,t1,t2,t3,t4,t5,t6,r1,r2,r3,r4,r5,r6)
   {
		//alert(2);
		//自适应宽高
		var myChartContainer = function () {
		    myChart.style.width = window.innerWidth+'px';
		    myChart.style.height = window.innerHeight+'px';
		};
		
        myChart.setOption({
				  title : {
        text: '水位流量关系图',
        x: 'center'
    },
    tooltip : {
        trigger: 'axis',
        formatter: function(params) {
            return params[0].name + '<br/>'
                   + params[0].seriesName + ' : ' + params[0].value + ' (m^3/s)<br/>'
                   + params[1].seriesName + ' : ' + -params[1].value + ' (cm)';
        }
    },
    legend: {
        data:['流量','水位'],
        x: 'left'
    },
    toolbox: {
        show : true,
        feature : {
            mark : {show: true},
            dataView : {show: true, readOnly: false},
            magicType : {show: true, type: ['line', 'bar']},
            restore : {show: true},
            saveAsImage : {show: true}
        }
    },
    dataZoom : {
        show : true,
        realtime : true,
        start : 0,
        end : 100
    },
    xAxis : [
        {
            type : 'category',
            boundaryGap : false,
            axisLine: {onZero: false},
            data : [
            t1,t2,t3,t4,t5,t6
                 //obj[5].time,obj[4].time,obj[3].time,obj[2].time,obj[1].time,obj[0].time
            ]
        }
    ],
    yAxis : [
        {
            name : '流量(m^3/s)',
            type : 'value',
            max : 300
        },
        {
            name : '水位(cm)',
            type : 'value',
            axisLabel : {
                formatter: function(v){
                    return - v;
                }
            }
        }
    ],
    series : [
        {
            name:'流量',
            type:'line',
            itemStyle: {normal: {areaStyle: {type: 'default'}}},
            data:[a,b,c,d,e,f
           // obj[5].flow,obj[4].flow,obj[3].flow,obj[2].flow,obj[1].flow,obj[0].flow
            ]
        },
        {
            name:'水位',
            type:'line',
            yAxisIndex:1,
            itemStyle: {normal: {areaStyle: {type: 'default'}}},
            data: (function(){
                var oriData = [
                r1,r2,r3,r4,r5,r6
                //obj[5].rain,obj[4].rain,obj[3].rain,obj[2].rain,obj[1].rain,obj[0].rain
                ];
                var len = oriData.length;
                while(len--) {
                    oriData[len] *= -1;
                }
                return oriData;
            })()
        }
    ]
			
            });
            
            
            

    }    
</script>
  
  

<script type="text/javascript">
		var obj=${message};
		var level="${warn.leveal}";
		var data=${warn.data};
		$(top.hangge());//关闭加载状态
		//rain(100,50,70,60,40,24);
		rain(obj[5].flow,obj[4].flow,obj[3].flow,obj[2].flow,obj[1].flow,obj[0].flow,obj[5].time,obj[4].time,obj[3].time,obj[2].time,obj[1].time,obj[0].time,obj[5].wlevel,obj[4].wlevel,obj[3].wlevel,obj[2].wlevel,obj[1].wlevel,obj[0].wlevel);
		//alert(4);
		
		$(document).ready(function() {
			init1();
		});
		
		function init1() {
			
	  	    
			  //alert(3);
           
             var hh=23, bs=21, jj=14, kh=17, fl=26, gq=17, qsp=19, as=13, lk=11, gy=22, cl=33, xs=23, xl=21, qt=14, ch=17, ll=14, hx=13, jb=12;

           
	                 var statesData = {"type":"FeatureCollection","features":[
						{"type":"Feature","id":"01","properties":{"name":"开慧镇","temperature":kh},"geometry":{"type":"Polygon","coordinates":[[
						[113.167402,28.572018],
						[113.164528,28.571003],
						[113.174876,28.574048],
						[113.184075,28.573541],
						[113.190399,28.573541],
						[113.201322,28.567957],
						[113.21397,28.5725260],
						[113.220294,28.578108],
						[113.237542,28.575571],
						[113.240417,28.569480],
						[113.258239,28.553237],
						[113.273187,28.551206],
						[113.298483,28.550191],
						[113.317455,28.550191],
						[113.328379,28.559328],
						[113.324929,28.565927],
						[113.319755,28.569480],
						[113.31918,28.5776010],
						[113.322629,28.583691],
						[113.328954,28.592826],
						[113.332403,28.597900],
						[113.324929,28.607033],
						[113.326654,28.615658],
						[113.332403,28.613629],
						[113.342177,28.607541],
						[113.350800,28.611600],
						[113.359424,28.617688],
						[113.361149,28.625297],
						[113.327229,28.624790],
						[113.312856,28.627327],
						[113.303657,28.630878],
						[113.288135,28.635950],
						[113.280086,28.640008],
						[113.272612,28.642037],
						[113.253065,28.638994],
						[113.241566,28.635443],
						[113.237542,28.630370],
						[113.226619,28.629356],
						[113.211096,28.638486],
						[113.203622,28.649138],
						[113.203047,28.655731],
						[113.197873,28.656745],
						[113.190399,28.648123],
						[113.189249,28.635443],
						[113.185225,28.630370],
						[113.181775,28.626819],
						[113.174301,28.621239],
						[113.166252,28.619717],
						[113.157054,28.617688],
						[113.150730,28.611600],
						[113.15073,28.6034820],
						[113.153604,28.592826],
						[113.158204,28.583184],
						[113.167402,28.572018]]]}},
						
						{"type":"Feature","id":"02","properties":{"name":"金井镇","temperature":jj},"geometry":{"type":"Polygon","coordinates":[[
						[113.361149,28.626312],
						[113.374947,28.631892],
						[113.381846,28.644066],
						[113.38932,28.6481230],
						[113.401968,28.638994],
						[113.413466,28.640008],
						[113.41864,28.6430510],
						[113.431863,28.644066],
						[113.431863,28.637979],
						[113.433013,28.630370],
						[113.438187,28.620224],
						[113.440487,28.617180],
						[113.435888,28.601959],
						[113.438187,28.591303],
						[113.449111,28.589781],
						[113.45716,28.6050040],
						[113.465209,28.611600],
						[113.479006,28.608555],
						[113.510052,28.576586],
						[113.511202,28.569480],
						[113.509477,28.555775],
						[113.48878,28.5395290],
						[113.472682,28.530390],
						[113.442212,28.522266],
						[113.435313,28.514141],
						[113.373797,28.524805],
						[113.357124,28.521758],
						[113.354825,28.514141],
						[113.335853,28.531406],
						[113.327229,28.538006],
						[113.317455,28.550698],
						[113.327229,28.560344],
						[113.324929,28.566435],
						[113.31918,28.5694800],
						[113.31918,28.5776010],
						[113.332403,28.598915],
						[113.324929,28.606526],
						[113.326079,28.615151],
						[113.332978,28.613629],
						[113.342752,28.608048],
						[113.359424,28.617688],
						[113.361149,28.626312]]]}},
						
						{"type":"Feature","id":"03","properties":{"name":"福临镇","temperature":fl},"geometry":{"type":"Polygon","coordinates":[[
						[113.163953,28.571510],
						[113.175451,28.575063],
						[113.184075,28.573541],
						[113.189824,28.573541],
						[113.199598,28.568465],
						[113.212246,28.572526],
						[113.220294,28.578108],
						[113.237542,28.575571],
						[113.239842,28.569480],
						[113.257664,28.554760],
						[113.273187,28.551206],
						[113.293884,28.550191],
						[113.307682,28.538514],
						[113.304807,28.528867],
						[113.296183,28.525820],
						[113.290434,28.520235],
						[113.291584,28.509570],
						[113.291584,28.493317],
						[113.288135,28.485190],
						[113.280661,28.474522],
						[113.261688,28.471474],
						[113.25364,28.4669010],
						[113.24789,28.4729980],
						[113.244441,28.478586],
						[113.242716,28.483666],
						[113.236392,28.484682],
						[113.227193,28.486206],
						[113.21512,28.4836660],
						[113.208221,28.486714],
						[113.208221,28.491794],
						[113.207646,28.501952],
						[113.205347,28.509062],
						[113.194998,28.508554],
						[113.190399,28.502968],
						[113.182925,28.498397],
						[113.178901,28.495857],
						[113.167402,28.499412],
						[113.156479,28.507031],
						[113.154754,28.512617],
						[113.153604,28.520742],
						[113.158779,28.522774],
						[113.160503,28.528359],
						[113.161653,28.536483],
						[113.163953,28.546129],
						[113.163953,28.556283],
						[113.163953,28.564912],
						[113.163953,28.571510]]]}},
						
						{"type":"Feature","id":"04","properties":{"name":"高桥镇","temperature":gq},"geometry":{"type":"Polygon","coordinates":[[
						[113.294459,28.549683],
						[113.306532,28.539022],
						[113.304232,28.529375],
						[113.296758,28.525820],
						[113.290434,28.519727],
						[113.291009,28.507539],
						[113.291584,28.494333],
						[113.288135,28.487222],
						[113.291584,28.472998],
						[113.291584,28.465377],
						[113.296183,28.454707],
						[113.305382,28.452674],
						[113.311131,28.453183],
						[113.322629,28.452674],
						[113.331828,28.443528],
						[113.341027,28.439970],
						[113.352525,28.435905],
						[113.372072,28.438954],
						[113.385295,28.436921],
						[113.406567,28.442003],
						[113.421515,28.458264],
						[113.427264,28.466901],
						[113.436463,28.470458],
						[113.442787,28.471982],
						[113.45256,28.4785860],
						[113.451411,28.488238],
						[113.449686,28.494841],
						[113.447961,28.497889],
						[113.442212,28.504491],
						[113.446236,28.513125],
						[113.448536,28.522774],
						[113.441062,28.522774],
						[113.435313,28.514141],
						[113.414616,28.518203],
						[113.400818,28.520742],
						[113.389895,28.522774],
						[113.376672,28.524297],
						[113.373222,28.525313],
						[113.357124,28.522266],
						[113.354825,28.514141],
						[113.344476,28.523789],
						[113.337577,28.529882],
						[113.330103,28.534960],
						[113.325504,28.540037],
						[113.32148,28.5451140],
						[113.317455,28.550191],
						[113.294459,28.549683]]]}},
						
						{"type":"Feature","id":"05","properties":{"name":"青山铺镇","temperature":qsp},"geometry":{"type":"Polygon","coordinates":[[
						[113.161653,28.501952],
						[113.168552,28.498397],
						[113.177176,28.496365],
						[113.179475,28.496873],
						[113.186949,28.500936],
						[113.191549,28.503476],
						[113.194423,28.509062],
						[113.205347,28.509570],
						[113.207646,28.500428],
						[113.207646,28.488746],
						[113.21627,28.4831580],
						[113.226044,28.486206],
						[113.242141,28.484174],
						[113.248465,28.470966],
						[113.247316,28.458264],
						[113.238117,28.452166],
						[113.231793,28.452166],
						[113.222594,28.453183],
						[113.21972,28.4567390],
						[113.21397,28.4552150],
						[113.211096,28.449626],
						[113.213396,28.439970],
						[113.211671,28.433872],
						[113.204772,28.430822],
						[113.190399,28.426756],
						[113.181775,28.430314],
						[113.172002,28.431839],
						[113.166252,28.431839],
						[113.153604,28.433872],
						[113.132907,28.444544],
						[113.125433,28.451658],
						[113.119109,28.461312],
						[113.121984,28.471474],
						[113.131758,28.476046],
						[113.139231,28.481634],
						[113.150155,28.490778],
						[113.156479,28.496873],
						[113.161653,28.501952]]]}},
						
						{"type":"Feature","id":"06","properties":{"name":"安沙镇","temperature":as},"geometry":{"type":"Polygon","coordinates":[[
						[113.119109,28.462837],
						[113.120259,28.468934],
						[113.111061,28.467917],
						[113.103587,28.466901],
						[113.103587,28.456739],
						[113.102437,28.448609],
						[113.093813,28.442003],
						[113.088639,28.435396],
						[113.084614,28.428789],
						[113.082315,28.419640],
						[113.08059,28.4079490],
						[113.076566,28.402865],
						[113.071391,28.391681],
						[113.074266,28.378461],
						[113.075416,28.367273],
						[113.068517,28.348964],
						[113.063917,28.328616],
						[113.063343,28.313862],
						[113.065067,28.299105],
						[113.061043,28.283329],
						[113.069092,28.271113],
						[113.07829,28.2644960],
						[113.092088,28.270604],
						[113.098412,28.275694],
						[113.103587,28.271622],
						[113.111061,28.267550],
						[113.119684,28.269077],
						[113.125433,28.277221],
						[113.124859,28.283838],
						[113.121984,28.289436],
						[113.126008,28.295543],
						[113.132907,28.300632],
						[113.14843,28.3047030],
						[113.156479,28.312335],
						[113.163378,28.319967],
						[113.173151,28.323020],
						[113.188099,28.325564],
						[113.194998,28.334212],
						[113.196148,28.343369],
						[113.192699,28.353541],
						[113.188099,28.358119],
						[113.194998,28.364222],
						[113.201897,28.371850],
						[113.201322,28.380494],
						[113.200747,28.386088],
						[113.194423,28.395748],
						[113.194423,28.403374],
						[113.209371,28.410999],
						[113.212246,28.417607],
						[113.207071,28.422182],
						[113.196723,28.428281],
						[113.190399,28.426756],
						[113.179475,28.429806],
						[113.166827,28.431839],
						[113.153029,28.434380],
						[113.140956,28.439970],
						[113.131758,28.444544],
						[113.124859,28.451150],
						[113.118534,28.461820],
						[113.119109,28.462837]]]}},
						
						{"type":"Feature","id":"07","properties":{"name":"北山镇","temperature":bs},"geometry":{"type":"Polygon","coordinates":[[
						[113.101862,28.449626],
						[113.093238,28.449117],
						[113.089789,28.453183],
						[113.092663,28.461820],
						[113.092088,28.466393],
						[113.085189,28.467409],
						[113.080015,28.467409],
						[113.073691,28.462837],
						[113.066792,28.464869],
						[113.065067,28.469442],
						[113.064492,28.471982],
						[113.056444,28.474014],
						[113.050694,28.471474],
						[113.04437,28.4684250],
						[113.036896,28.467917],
						[113.035747,28.477062],
						[113.037471,28.481634],
						[113.036896,28.485698],
						[113.028273,28.487730],
						[113.023098,28.483158],
						[113.017349,28.479602],
						[113.01390,28.4770620],
						[113.01390,28.4699500],
						[113.009875,28.463853],
						[113.009875,28.455723],
						[113.008726,28.448101],
						[113.007576,28.440479],
						[112.999527,28.435905],
						[113.000102,28.427773],
						[112.998952,28.421674],
						[112.988604,28.417099],
						[112.982854,28.411507],
						[112.98113,28.4023570],
						[112.98113,28.3947310],
						[112.989178,28.386596],
						[112.991478,28.376427],
						[112.988029,28.370324],
						[112.98113,28.3606620],
						[112.974231,28.353541],
						[112.97998,28.3382820],
						[112.989753,28.339808],
						[113.005276,28.341842],
						[113.018499,28.345912],
						[113.028273,28.342860],
						[113.035172,28.337773],
						[113.039771,28.333195],
						[113.04897,28.3321770],
						[113.064492,28.335230],
						[113.067367,28.348455],
						[113.072541,28.358627],
						[113.075416,28.367782],
						[113.073691,28.385071],
						[113.071391,28.393206],
						[113.077141,28.402865],
						[113.08059,28.4089660],
						[113.08289,28.4252320],
						[113.088064,28.435396],
						[113.092663,28.442003],
						[113.097263,28.445560],
						[113.101862,28.449626]]]}},
						
						{"type":"Feature","id":"08","properties":{"name":"路口镇","temperature":lk},"geometry":{"type":"Polygon","coordinates":[[
						[113.286985,28.486714],
						[113.289859,28.478586],
						[113.292159,28.472998],
						[113.291584,28.467917],
						[113.295608,28.455215],
						[113.305957,28.452674],
						[113.32148,28.4521660],
						[113.331828,28.444544],
						[113.351375,28.436921],
						[113.371497,28.439462],
						[113.38472,28.4379380],
						[113.407717,28.442003],
						[113.412316,28.425740],
						[113.406567,28.420149],
						[113.405992,28.413541],
						[113.409442,28.401340],
						[113.408292,28.388121],
						[113.403118,28.377444],
						[113.397943,28.374392],
						[113.390469,28.372358],
						[113.383571,28.376427],
						[113.374372,28.368799],
						[113.368048,28.358627],
						[113.362299,28.341334],
						[113.351375,28.336756],
						[113.337577,28.337773],
						[113.318605,28.340825],
						[113.301932,28.340825],
						[113.288709,28.334212],
						[113.274337,28.348964],
						[113.264563,28.356593],
						[113.243291,28.360153],
						[113.237542,28.354559],
						[113.239842,28.340316],
						[113.224894,28.333703],
						[113.211096,28.338282],
						[113.196148,28.343877],
						[113.192124,28.354050],
						[113.188099,28.358627],
						[113.200747,28.371850],
						[113.200747,28.386596],
						[113.193848,28.394731],
						[113.194423,28.402865],
						[113.208221,28.411507],
						[113.211671,28.417607],
						[113.196723,28.428281],
						[113.211096,28.435396],
						[113.212821,28.440987],
						[113.211671,28.448609],
						[113.212821,28.455215],
						[113.21857,28.4572480],
						[113.222594,28.453183],
						[113.236967,28.453183],
						[113.246166,28.458264],
						[113.248465,28.472490],
						[113.25364,28.4674090],
						[113.262838,28.472490],
						[113.280661,28.474522],
						[113.286985,28.486714]]]}},
						
						{"type":"Feature","id":"09","properties":{"name":"果园镇","temperature":gy},"geometry":{"type":"Polygon","coordinates":[[
						[113.196723,28.343369],
						[113.222594,28.335230],
						[113.225469,28.334212],
						[113.238692,28.340316],
						[113.237542,28.354559],
						[113.242141,28.361170],
						[113.265138,28.357102],
						[113.28756,28.3347210],
						[113.289284,28.316406],
						[113.297333,28.302667],
						[113.294459,28.294525],
						[113.28411,28.2879090],
						[113.277211,28.287401],
						[113.268012,28.291472],
						[113.259964,28.290963],
						[113.260539,28.282311],
						[113.255364,28.275694],
						[113.243291,28.270604],
						[113.229493,28.274676],
						[113.21857,28.2797660],
						[113.203047,28.286892],
						[113.185225,28.290454],
						[113.162228,28.295034],
						[113.150155,28.301141],
						[113.14728,28.3052120],
						[113.163378,28.320476],
						[113.188674,28.325055],
						[113.194998,28.334721],
						[113.196723,28.343369]]]}},
						
						{"type":"Feature","id":"10","properties":{"name":"长龙街道","temperature":cl},"geometry":{"type":"Polygon","coordinates":[[
						[113.147855,28.303685],
						[113.132907,28.300632],
						[113.126008,28.295034],
						[113.121984,28.289945],
						[113.125433,28.278239],
						[113.119684,28.270095],
						[113.120834,28.258387],
						[113.128883,28.241077],
						[113.138082,28.233440],
						[113.152454,28.235476],
						[113.159353,28.244641],
						[113.169127,28.250242],
						[113.176026,28.243623],
						[113.194998,28.249733],
						[113.208221,28.244132],
						[113.215695,28.246169],
						[113.227768,28.236495],
						[113.25134,28.2385310],
						[113.259389,28.246169],
						[113.258814,28.255842],
						[113.254215,28.267041],
						[113.25019,28.2746760],
						[113.243866,28.270604],
						[113.226044,28.275185],
						[113.208796,28.283838],
						[113.201322,28.287909],
						[113.178326,28.292999],
						[113.157054,28.297070],
						[113.147855,28.303685]]]}},
						
						{"type":"Feature","id":"11","properties":{"name":"星沙街道","temperature":xs},"geometry":{"type":"Polygon","coordinates":[[
						[113.119109,28.269077],
						[113.119684,28.259914],
						[113.126583,28.242605],
						[113.136357,28.233949],
						[113.15188,28.2364950],
						[113.161653,28.216125],
						[113.068517,28.211033],
						[113.078865,28.263987],
						[113.092088,28.272131],
						[113.097837,28.275694],
						[113.111061,28.267550],
						[113.119109,28.270095],
						[113.119109,28.269077]]]}},
						
						{"type":"Feature","id":"12","properties":{"name":"湘龙街道","temperature":xl},"geometry":{"type":"Polygon","coordinates":[[
						[113.077715,28.264496],
						[113.067942,28.210523],
						[113.061618,28.196262],
						[113.055294,28.196771],
						[113.054144,28.201865],
						[113.04897,28.2191810],
						[113.032872,28.225801],
						[113.020224,28.230384],
						[113.017349,28.240568],
						[113.017349,28.248714],
						[113.024823,28.255842],
						[113.028273,28.264496],
						[113.032297,28.273149],
						[113.046095,28.279257],
						[113.058168,28.281802],
						[113.062768,28.281802],
						[113.067942,28.271622],
						[113.07829,28.2644960],
						[113.077715,28.264496]]]}},
						
						{"type":"Feature","id":"13","properties":{"name":"泉塘街道","temperature":qt},"geometry":{"type":"Polygon","coordinates":[[
						[113.068517,28.212051],
						[113.061043,28.196771],
						[113.073116,28.193205],
						[113.086339,28.191677],
						[113.104162,28.189640],
						[113.11566,28.1835270],
						[113.130033,28.178942],
						[113.139231,28.183527],
						[113.141531,28.189640],
						[113.15073,28.1947340],
						[113.161653,28.192187],
						[113.172577,28.192187],
						[113.175451,28.198809],
						[113.167977,28.212560],
						[113.160503,28.216125],
						[113.126008,28.213579],
						[113.093813,28.213070],
						[113.067942,28.212051]]]}},
						
						{"type":"Feature","id":"14","properties":{"name":"春华镇","temperature":ch},"geometry":{"type":"Polygon","coordinates":[[
						[113.403693,28.378969],
						[113.416916,28.363205],
						[113.421515,28.354050],
						[113.41864,28.3474380],
						[113.419215,28.329634],
						[113.420365,28.320985],
						[113.415191,28.302667],
						[113.411741,28.291472],
						[113.410592,28.282820],
						[113.408867,28.271622],
						[113.407142,28.260933],
						[113.397368,28.246678],
						[113.392769,28.238531],
						[113.389895,28.223764],
						[113.382996,28.208486],
						[113.384145,28.198809],
						[113.376672,28.185055],
						[113.359999,28.175375],
						[113.347351,28.171809],
						[113.323779,28.172318],
						[113.306532,28.178942],
						[113.295034,28.183017],
						[113.277211,28.191677],
						[113.263413,28.201865],
						[113.263413,28.208995],
						[113.272037,28.225801],
						[113.269737,28.233440],
						[113.257089,28.244641],
						[113.258814,28.256351],
						[113.250765,28.275185],
						[113.260539,28.284856],
						[113.259389,28.291472],
						[113.268587,28.290454],
						[113.276061,28.287909],
						[113.28411,28.2894360],
						[113.293884,28.295034],
						[113.296183,28.303176],
						[113.288135,28.317423],
						[113.28756,28.3347210],
						[113.301932,28.342351],
						[113.31918,28.3408250],
						[113.35195,28.3377730],
						[113.362874,28.342860],
						[113.367473,28.358119],
						[113.373222,28.369307],
						[113.383571,28.377444],
						[113.390469,28.373884],
						[113.404267,28.377952],
						[113.403693,28.378969]]]}},
						
						{"type":"Feature","id":"15","properties":{"name":"黄花镇","temperature":hh},"geometry":{"type":"Polygon","coordinates":[[
						[113.257664,28.244132],
						[113.269737,28.234458],
						[113.271462,28.225292],
						[113.263988,28.208486],
						[113.263413,28.201865],
						[113.277786,28.190149],
						[113.296758,28.181998],
						[113.324354,28.172828],
						[113.346201,28.172318],
						[113.360574,28.175885],
						[113.376672,28.185564],
						[113.383571,28.171809],
						[113.392769,28.164166],
						[113.407717,28.159580],
						[113.406567,28.142254],
						[113.404842,28.130532],
						[113.396219,28.121867],
						[113.384145,28.130022],
						[113.372647,28.131042],
						[113.361149,28.126454],
						[113.338727,28.120338],
						[113.315156,28.122377],
						[113.299058,28.124415],
						[113.28641,28.1305320],
						[113.276061,28.128493],
						[113.261688,28.127983],
						[113.248465,28.130022],
						[113.246741,28.145822],
						[113.242716,28.151427],
						[113.236392,28.153466],
						[113.229493,28.160090],
						[113.224894,28.156013],
						[113.223744,28.152956],
						[113.213396,28.151427],
						[113.204772,28.154485],
						[113.194998,28.159071],
						[113.180625,28.167733],
						[113.174301,28.178942],
						[113.172002,28.192696],
						[113.175451,28.199827],
						[113.167402,28.212560],
						[113.160503,28.217144],
						[113.151305,28.237004],
						[113.160503,28.246678],
						[113.168552,28.250751],
						[113.173726,28.244641],
						[113.194423,28.250242],
						[113.207646,28.244132],
						[113.214545,28.247187],
						[113.227193,28.237513],
						[113.251915,28.239041],
						[113.257664,28.244132]]]}},
						
						{"type":"Feature","id":"16","properties":{"name":"榔梨街道","temperature":ll},"geometry":{"type":"Polygon","coordinates":[[
						[113.171427,28.193715],
						[113.173726,28.178942],
						[113.180625,28.167733],
						[113.200172,28.156523],
						[113.196723,28.144293],
						[113.196723,28.137158],
						[113.206497,28.129003],
						[113.212246,28.121867],
						[113.21627,28.1126910],
						[113.215695,28.102495],
						[113.197873,28.091278],
						[113.184075,28.090769],
						[113.168552,28.098926],
						[113.159928,28.116260],
						[113.153029,28.124925],
						[113.139806,28.130532],
						[113.136357,28.152956],
						[113.128308,28.155504],
						[113.123709,28.164676],
						[113.126008,28.173847],
						[113.128883,28.180470],
						[113.139231,28.183527],
						[113.139806,28.190658],
						[113.14958,28.1957520],
						[113.159928,28.193715],
						[113.170852,28.194734],
						[113.171427,28.193715]]]}},
						
						{"type":"Feature","id":"17","properties":{"name":"黄兴镇","temperature":hx},"geometry":{"type":"Polygon","coordinates":[[
						[113.200747,28.156523],
						[113.213396,28.151427],
						[113.224894,28.153466],
						[113.224894,28.156523],
						[113.229493,28.161109],
						[113.235242,28.155504],
						[113.243291,28.152446],
						[113.247316,28.146331],
						[113.24789,28.1320610],
						[113.261688,28.127474],
						[113.277786,28.127983],
						[113.285835,28.131551],
						[113.299058,28.124925],
						[113.337577,28.119828],
						[113.356549,28.125945],
						[113.361149,28.113711],
						[113.353675,28.105554],
						[113.35080,28.0958670],
						[113.345626,28.086180],
						[113.343326,28.077001],
						[113.343901,28.065271],
						[113.343326,28.037217],
						[113.331253,28.028035],
						[113.330103,28.016810],
						[113.32148,28.0152790],
						[113.313431,28.023953],
						[113.305957,28.020892],
						[113.302507,28.014769],
						[113.291009,28.018341],
						[113.28526,28.0229330],
						[113.280661,28.016810],
						[113.277786,28.015790],
						[113.263988,28.016300],
						[113.253065,28.020892],
						[113.248465,28.032116],
						[113.245591,28.042829],
						[113.236967,28.046910],
						[113.223169,28.040278],
						[113.21627,28.0372170],
						[113.195573,28.038238],
						[113.176601,28.040278],
						[113.157629,28.046400],
						[113.143256,28.056091],
						[113.131183,28.065781],
						[113.127158,28.079551],
						[113.128308,28.096887],
						[113.145555,28.109633],
						[113.160503,28.109123],
						[113.165678,28.109123],
						[113.167977,28.100456],
						[113.18350,28.0912780],
						[113.198448,28.092298],
						[113.215695,28.103005],
						[113.215695,28.112691],
						[113.212246,28.125435],
						[113.195573,28.137158],
						[113.197298,28.147860],
						[113.199598,28.156013],
						[113.200747,28.156523]]]}},
						
						{"type":"Feature","id":"18","properties":{"name":"江背镇","temperature":jb},"geometry":{"type":"Polygon","coordinates":[[
						[113.406567,28.159580],
						[113.41864,28.1585610],
						[113.433013,28.162638],
						[113.445661,28.168242],
						[113.458884,28.173337],
						[113.470383,28.173337],
						[113.479581,28.172318],
						[113.481881,28.168752],
						[113.471533,28.162128],
						[113.468083,28.158052],
						[113.468658,28.150408],
						[113.477857,28.148370],
						[113.49223,28.1493890],
						[113.506602,28.148370],
						[113.518101,28.143273],
						[113.519825,28.134100],
						[113.518101,28.126454],
						[113.507177,28.123396],
						[113.496254,28.121357],
						[113.49108,28.1152400],
						[113.487055,28.109123],
						[113.488205,28.104025],
						[113.48993,28.0958670],
						[113.48993,28.0902590],
						[113.48763,28.0826100],
						[113.484181,28.075981],
						[113.481306,28.065271],
						[113.474407,28.053031],
						[113.465209,28.038238],
						[113.45831,28.0316060],
						[113.443937,28.033136],
						[113.436463,28.032116],
						[113.435888,28.022933],
						[113.436463,28.013749],
						[113.436463,28.005074],
						[113.442787,28.001502],
						[113.442787,27.994868],
						[113.439337,27.990785],
						[113.427264,27.983639],
						[113.419215,27.986702],
						[113.417491,27.994868],
						[113.410592,27.999461],
						[113.401393,27.998440],
						[113.390469,27.993337],
						[113.375522,27.997419],
						[113.366898,28.004053],
						[113.351375,28.011197],
						[113.341602,28.014769],
						[113.330678,28.023443],
						[113.331253,28.028545],
						[113.331253,28.029055],
						[113.343326,28.036707],
						[113.342177,28.075981],
						[113.346776,28.091278],
						[113.35195,28.0984170],
						[113.35425,28.1075930],
						[113.361149,28.114221],
						[113.356549,28.125945],
						[113.372072,28.132061],
						[113.384145,28.130022],
						[113.395644,28.122377],
						[113.403693,28.131042],
						[113.407717,28.160599],
						[113.406567,28.159580]]]}},
						
						]};

	              	//var map = L.map('map').setView([28.297401,113.287211], 10.3);
	              	var map = L.map('map').setView([28.297401,113.287211], 9.3);

					L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw', {
						maxZoom: 18,
						attribution: '',
						id: 'mapbox.light'
					}).addTo(map);
				
				
					// control that shows state info on hover
					var info = L.control();
				
					info.onAdd = function (map) {
						this._div = L.DomUtil.create('div', 'info');
						this.update();
						return this._div;
					};
				
					info.update = function (props) {
						this._div.innerHTML = '<h4>长沙各县降雨量</h4>' +  (props ?
							'<b>' + props.name + '</b><br /> <h1>' + props.temperature + '</h1>' + ' 毫米 (mm)' 
							 : '请把鼠标移动到地图上方');
					};
				
					info.addTo(map);
				
					// get color depending on temperature value
					function getColor(d) {
						return d > 35 ? '#800026' :
								d > 30  ? '#BD0026' :
								d > 25  ? '#E31A1C' :
								d > 20  ? '#FC4E2A' :
								d > 15  ? '#FD8D3C' :
								d > 10  ? '#FEB24C' :
								d > 5   ? '#FED976' :
									   	  '#FFEDA0' ;
					}
				
					function style(feature) {
					//alert(hh);
						return {
							weight: 2,
							opacity: 1,
							color: 'white',
							dashArray: '3',
							fillOpacity: 0.7,
							fillColor: getColor(feature.properties.temperature)
						};
					}
				
					function highlightFeature(e) {
						var layer = e.target;
				
						layer.setStyle({
							weight: 5,
							color: '#666',
							dashArray: '',
							fillOpacity: 0.7
						});
				
						if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
							layer.bringToFront();
						}
				
						info.update(layer.feature.properties);
					}
				
					var geojson;
				
					function resetHighlight(e) {
						geojson.resetStyle(e.target);
						info.update();
					}
				
					function zoomToFeature(e) {
					    var layer1 = e.target;
						map.fitBounds(e.target.getBounds());
						if(layer1.feature.properties.name=="开慧镇")
						{
						  $.ajax({
								    async : false,
								    cache : false,
								    type : 'POST',
								    url : "sensordata/ajax?aid="+7320,  //开慧镇的区域编号为7320
								    error : function() {
								        alert('更新数据失败 ');
								    },
								    success : function(data) {
								    
								    //var obj = data.parseJSON();
									var obj = eval("(" + data + ")");
									//alert(obj[0].flow);
									/*for (var i = 0; i < data.length; i++) {
								        //result[i]表示获得第i个json对象即JSONObject
								        //result[i]通过.字段名称即可获得指定字段的值
								        alert(data[i].flow);
								    }*/
								   //a=200,b=150,c=170,d=160,e=140,f=124;
								    //rain(200,150,170,160,140,124);
								    rain(obj[5].flow,obj[4].flow,obj[3].flow,obj[2].flow,obj[1].flow,obj[0].flow,obj[5].time,obj[4].time,obj[3].time,obj[2].time,obj[1].time,obj[0].time,obj[5].rain,obj[4].rain,obj[3].rain,obj[2].rain,obj[1].rain,obj[0].rain);
								    }
								});
								
						}
						if(layer1.feature.properties.name=="北山镇")
						   window.location.href="<%=basePath%>chart5/rainstatistics"; 
						if(layer1.feature.properties.name=="黄花镇")
						   window.location.href="<%=basePath%>chart5/rainstatistics";
						   if(layer1.feature.properties.name=="金井镇")
						   window.location.href="<%=basePath%>chart5/rainstatistics";
						   if(layer1.feature.properties.name=="福临镇")
						   window.location.href="<%=basePath%>chart5/rainstatistics";
						   if(layer1.feature.properties.name=="高桥镇")
						   window.location.href="<%=basePath%>chart5/rainstatistics";
						   if(layer1.feature.properties.name=="青山铺镇")
						   window.location.href="<%=basePath%>chart5/rainstatistics";
						   if(layer1.feature.properties.name=="安山镇")
						   window.location.href="<%=basePath%>chart5/rainstatistics";
						   if(layer1.feature.properties.name=="路口镇")
						   window.location.href="<%=basePath%>chart5/rainstatistics";
						   if(layer1.feature.properties.name=="果园镇")
						   window.location.href="<%=basePath%>chart5/rainstatistics";
						   if(layer1.feature.properties.name=="黄兴镇")
						   window.location.href="<%=basePath%>chart5/rainstatistics";
						   if(layer1.feature.properties.name=="江背镇")
						   window.location.href="<%=basePath%>chart5/rainstatistics";
						   if(layer1.feature.properties.name=="春华镇")
						   window.location.href="<%=basePath%>chart5/rainstatistics";
						   if(layer1.feature.properties.name=="长龙街道")
						   window.location.href="<%=basePath%>chart5/rainstatistics";
						   if(layer1.feature.properties.name=="星沙街道")
						   window.location.href="<%=basePath%>chart5/rainstatistics";
						   if(layer1.feature.properties.name=="湘龙街道")
						   window.location.href="<%=basePath%>chart5/rainstatistics";
						   if(layer1.feature.properties.name=="泉塘街道")
						   window.location.href="<%=basePath%>chart5/rainstatistics";
						   if(layer1.feature.properties.name=="泉塘街道")
						   window.location.href="<%=basePath%>chart5/rainstatistics"; 
					}
					
				
				
				   
					function onEachFeature(feature, layer) {
						layer.on({
							mouseover: highlightFeature,
							mouseout: resetHighlight,
							click: zoomToFeature
						});
					}
				
					geojson = L.geoJson(statesData, {
						style: style,
						onEachFeature: onEachFeature
					}).addTo(map);
				
					var legend = L.control({position: 'bottomright'});
				
					legend.onAdd = function (map) {
				
						var div = L.DomUtil.create('div', 'info legend'),
							grades = [0, 5, 10, 15, 20, 25, 30, 35],
							labels = [],
							from, to;
				
						for (var i = 0; i < grades.length; i++) {
							from = grades[i];
							to = grades[i + 1];
				
							labels.push(
								'<i style="background:' + getColor(from + 1) + '"></i> ' + '&nbsp;' +
								from + (to ? '&ndash;' + to : '+') + '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;');
						}
				
						div.innerHTML = labels.join('<br>');
						return div;
					};
				
					legend.addTo(map);   
	                 
	  	        
	  	       	
		}
		if(obj[0].wlevel>data){
		alert('当前水位预警级别为:'+level+'。 已超过预警值!请发送预警信息');
		}
</script>

  
  
  
  
  
 



</body>
</html>